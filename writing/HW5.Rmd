---
title: "HW5"
author: "Amy Gill"
date: "2025-11-30"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}

packages <- c("tidyverse", "sf", "tigris", "forcats", "lubridate", "knitr")
install.packages(setdiff(packages, rownames(installed.packages())))

library(tidyverse)
library(sf)
library(tigris)
library(forcats)
library(lubridate)

options(tigris_use_cache = TRUE)
```


```{r pressure, echo=FALSE}

homicides <- read_csv("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv")

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


#Choosing city
```{r}
city_name <- "Baltimore"
state_abbrev <- "MD"

city_data <- homicides %>%
  filter(city == city_name, state == state_abbrev)
```


#Convert homicide points to sf 
```{r}
city_sf <- city_data %>%
  st_as_sf(coords = c("lon", "lat"), crs = 4326, remove = FALSE)
```


#Download Census boundaries with tigris and use tracts.
```{r}
tracts <- tracts(
  state = state_abbrev,
  county = "510",
  year = 2020) %>%
  st_transform(4326)
```
#5
```{r}
city_sf <- city_sf %>%
  mutate(
    race_clean = fct_lump(f = as.factor(victim_race), n = 3))
```

#6
```{r}
city_sf <- city_sf %>%
  mutate(
    solved = case_when(
      disposition %in% c("Closed without arrest", "Open/No arrest") ~ "Unsolved",
      TRUE ~ "Solved"
    ))
```


#7 Plot ~Homicides with county
```{r}
ggplot() +
  geom_sf(data = tracts, fill = "gray95", color = "gray70") +
  geom_sf(data = city_sf, aes(color = race_clean), alpha = 0.8, size = 1.8) +
  facet_wrap(~solved) +
  scale_color_brewer(palette = "Dark2", name = "Race") +
  labs(
    title = paste("Homicides in", city_name, state_abbrev),
    subtitle = "Faceted by case status (Solved vs Unsolved)",
    caption = "Source: Washington Post homicide dataset"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    panel.grid = element_blank(),
    strip.text = element_text(size = 14, face = "bold")
  )
```


